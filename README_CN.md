# 华为备忘录提取工具 / Huawei Notepad Extractor

一个用于批量提取华为手机备忘录内容的Python脚本，支持文字提取和截图保存。

English | [中文文档](README.md)

## ⚠️ 免责声明

本工具仅供**个人学习和备份**使用，**严禁商业用途**。
- 使用本工具产生的任何问题，作者不承担责任
- 请确保你有权访问和备份自己的数据  
- 华为官方可能随时更新UI导致脚本失效
- 使用前建议先在少量数据上测试
- **禁止将本工具转售或用于盈利**

## ✨ 功能特点

- ✅ **三种提取模式**：全自动/最后一屏补漏/带截图模式
- ✅ **智能去重**：基于内容去重，支持同一天多条记录
- ✅ **完整提取**：提取标题、时间戳、正文内容
- ✅ **手绘支持**：截图保存手绘/图片备忘录
- ✅ **自动命名**：根据备忘录文件夹名自动命名输出文件
- ✅ **非破坏性**：只读取数据，不修改/删除原备忘录

## 📋 系统要求

### 必需软件
- **Python 3.7+**
- **ADB (Android Debug Bridge)**
- **华为/荣耀手机**（使用华为备忘录APP）

### 已测试设备
- 华为低端机型（Android 版本未知，2020年左右机型）

*理论上支持所有使用华为备忘录APP的设备*

## 🚀 快速开始

### 1. 安装Python

#### Windows:
1. 访问 [Python官网](https://www.python.org/downloads/)
2. 下载最新版Python 3.x
3. **重要**：安装时勾选 "Add Python to PATH"
4. 验证安装：打开命令提示符，输入 `python --version`

#### macOS:
```bash
# 使用Homebrew安装
brew install python3

# 验证安装
python3 --version
```

#### Linux:
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install python3 python3-pip

# 验证安装
python3 --version
```

### 2. 安装ADB

#### Windows:
本仓库已包含ADB工具（platform-tools文件夹），无需额外安装。

或者从 [Google官方](https://developer.android.com/studio/releases/platform-tools) 下载最新版。

#### macOS:
```bash
brew install android-platform-tools
```

#### Linux:
```bash
sudo apt install android-tools-adb
```

验证安装：
```bash
adb version
```

### 3. 手机设置

1. **开启开发者选项**：
   - 进入 设置 → 关于手机
   - 连续点击"版本号" 7次
   - 返回设置，找到"开发者选项"

2. **开启USB调试**：
   - 进入 开发者选项
   - 开启 "USB调试"
   - 连接电脑时，手机上授权"允许USB调试"

3. **验证连接**：
   ```bash
   adb devices
   ```
   应该看到你的设备列表

### 4. 运行脚本

1. **下载本仓库**：
   ```bash
   git clone https://github.com/你的用户名/huawei-notepad-extractor.git
   cd huawei-notepad-extractor
   ```

2. **进入ADB工具目录**（如果使用仓库自带的）：
   ```bash
   cd platform-tools
   ```

3. **打开华为备忘录APP**，进入要提取的文件夹（例如"梦境记录"）

4. **运行脚本**：
   ```bash
   python auto_extract_notes_ultimate.py
   ```

5. **选择模式**：
   ```
   模式选择：
     1. 全自动模式 - 从头提取到底（推荐）
     2. 最后一屏模式 - 只提取当前屏幕
     3. 带截图模式 - 提取文字 + 保存截图
   选择模式 (1/2/3): 
   ```

## 📖 使用说明

### 模式1：全自动模式（推荐）
- **适用场景**：提取整个文件夹的所有备忘录
- **操作步骤**：
  1. 手动滑到备忘录列表**最顶部**
  2. 选择模式1，按回车
  3. 脚本自动提取直到最后一条
- **输出**：`文件夹名.txt`

### 模式2：最后一屏模式
- **适用场景**：补漏，提取最后几条没提取到的
- **操作步骤**：
  1. 手动滑到备忘录列表**最底部**
  2. 选择模式2，按回车
  3. 脚本提取当前屏幕的5条
- **输出**：`文件夹名.txt`

### 模式3：带截图模式
- **适用场景**：有手绘/图片的备忘录
- **操作步骤**：
  1. 进入包含手绘的文件夹
  2. 手动滑到列表**最顶部**
  3. 选择模式3，按回车
  4. 脚本提取文字+截图
- **输出**：
  - `文件夹名.txt` - 文字内容
  - `文件夹名_screenshots/` - 截图文件夹

### 输出文件示例

```
==================================================
备忘录 #1 - 梦境记录 - 12月27日 03:14
==================================================
今天梦到了一个很奇怪的场景...
（备忘录内容）

[📸 截图: 梦境记录_screenshots/note_0001.png]  （如果是模式3）
```

## 🔧 坐标调整（如果点击位置不准）

由于不同设备的**屏幕分辨率**不同，点击坐标可能需要调整。

### 症状
- 脚本运行时点击位置不对
- 没有打开备忘录详情页
- 点到了其他位置

### 解决方法

#### 方法1：使用在线工具测量坐标
1. **截图当前屏幕**：
   ```bash
   adb shell screencap -p /sdcard/screen.png
   adb pull /sdcard/screen.png .
   ```

2. **使用以下工具测量坐标**（任选一个）：
   - [Photopea](https://www.photopea.com/) - 免费在线PS，打开图片后鼠标移动即可看到坐标
   - [GIMP](https://www.gimp.org/) - 免费开源图像编辑软件
   - [Paint.NET](https://www.getpaint.net/) - Windows免费工具
   - [Pixlr](https://pixlr.com/) - 在线图片编辑器
   - Windows自带**画图**：打开图片，鼠标移动时左下角显示坐标

3. **测量以下位置的中心坐标**：
   - 第一条备忘录的中心点（通常在列表上方1/4处）
   - 最后一屏的5个备忘录中心点（从上往下）

4. **修改脚本**：
   - 打开 `auto_extract_notes_ultimate.py`
   - 搜索 `tap(350, 560)` 
   - 替换为你测量的坐标 `tap(你的x, 你的y)`
   - 搜索 `POSITIONS = [640, 880, 1140, 1395, 1654]`
   - 替换为你测量的5个y坐标

#### 方法2：使用ADB查看实时坐标
```bash
# 开启指针位置显示
adb shell settings put system pointer_location 1

# 在手机上点击，观察屏幕顶部的坐标
# 记录第一条备忘录的坐标

# 关闭指针位置
adb shell settings put system pointer_location 0
```

## ⚠️ 注意事项

### 使用前
- ✅ 确保手机电量充足（避免中途断电）
- ✅ 关闭手机自动锁屏（设置 → 显示 → 休眠 → 永不）
- ✅ 保持USB连接稳定
- ✅ 先在少量数据上测试

### 使用中
- ⚠️ **不要触摸手机屏幕**（会干扰脚本）
- ⚠️ **不要断开USB连接**
- ⚠️ 如果需要中断，直接关闭命令行窗口
- ⚠️ 脚本每30次点击会暂停3秒（正常现象）

### 特殊情况
- 📝 **纯手绘备忘录**：内容为空，但会保存截图（模式3）
- 📝 **重复内容**：连续3次检测到相同内容，自动判定到底
- 📝 **时间戳**：自动提取创建/修改时间
- 📝 **文件夹名**：自动识别华为备忘录文件夹名作为输出文件名

### 已知限制
- ❌ 不支持语音备忘录
- ❌ 截图只保存第一屏（长内容需翻页查看）
- ❌ 图片/手绘内容只能截图，无法提取原图
- ❌ 不支持OPPO、小米等其他品牌的备忘录APP

## 🐛 常见问题

### Q: 提示"adb不是内部或外部命令"
**A:** ADB未正确安装或未添加到PATH
- Windows: 确保在platform-tools文件夹内运行脚本
- 或者将platform-tools文件夹路径添加到系统环境变量

### Q: 提示"no devices/emulators found"
**A:** 手机未正确连接
1. 检查USB线是否连接
2. 手机上是否授权了USB调试
3. 运行 `adb devices` 查看设备列表

### Q: 脚本点击位置不对
**A:** 需要调整坐标，参见"坐标调整"章节

### Q: 提取的内容为空
**A:** 可能原因：
1. 备忘录本身为纯手绘（使用模式3）
2. UI结构变化（华为更新了APP）
3. 点击位置不对，没有进入详情页

### Q: 可以提取多个文件夹吗？
**A:** 需要手动切换文件夹，每次提取一个文件夹

### Q: 脚本会删除我的备忘录吗？
**A:** **不会**！脚本只读取数据，不做任何修改/删除操作

### Q: 提取1000+条备忘录要多久？
**A:** 
- 模式1/2：约20-30分钟（每条约1秒）
- 模式3：约40-60分钟（需要截图）

## 🤝 贡献

欢迎提交Issue和Pull Request！

### 提交Issue时请提供：
- 手机型号和Android版本
- 错误信息截图
- `window_dump.xml` 文件（如果是坐标问题）

### 提交PR时请：
- 说明适配的新设备型号
- 提供测试截图

## 👥 作者

**Jessica & Claude**
- Jessica：原创思路、测试与迭代
- Claude (Anthropic)：开发协助与优化

本项目展示了人类创造力与AI能力的协作。Jessica发现问题、设计解决方案并提供迭代反馈，Claude实现技术细节和优化。

## 📄 协议

MIT License - 详见 [LICENSE](LICENSE) 文件

**⚠️ 重要**：这是一个**非商业工具**。任何商业使用、转售或以盈利为目的的再分发都**严格禁止**，违反许可条款。

## 🙏 致谢

感谢所有测试和反馈的用户！

---

**注意**：本项目与华为公司无关，仅为个人开发的数据备份工具。
